<!DOCTYPE html>

<html class="no-js" lang="en" class="js flexbox canvas canvastext webgl no-touch geolocation postmessage no-websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients no-cssreflections csstransforms csstransforms3d csstransitions fontface generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths">
<head id="ContentPlaceHolderDefault_Head1">
    <meta http-equiv="X-UA-Compatible" content="IE=9,chrome=1" />
    <meta charset=UTF-8" />
    <title>Windows Azure 培训包 - 使用 WebMatrix 在 Windows Azure 中创建网站</title>
    <link rel="Stylesheet" type="text/css" media="all" href="styles/master.css" />
</head>
<body id="top" class="page-">
    <div id="page">
        <div id="wrapper" class="landingPage getStartedPage">            
            <div class="header">								
				<img alt="Windows Azure" src="images/azure-logo.png" /> <span class="mainHomepageSubTitle">培训包 - 2012 年 12 月更新</span>								
			</div>			
			<div class="nav-menu-header">
				<nav>
					<ul>
						<li class="MenuLink-Selected">
							<a href="#">内容</a>
						</li>
											</ul>
				
										
						<span id="github-btn" class="github-btn"> <a id="gh-btn" title="在 GitHub 中复制此存储库的分支" href="https://github.com/WindowsAzure-TrainingKit/HOL-WebAppGalleryAzureWebSites" target="_blank" class="gh-btn"> <span class="gh-ico"></span> <span id="gh-text" class="gh-text">分支</span> </a> </span> <span id="github-btn" class="github-btn github-watchers"> <a id="gh-btn" title="在 GitHub 中关注此存储库" href="https://github.com/WindowsAzure-TrainingKit/HOL-WebAppGalleryAzureWebSites" target="_blank" class="gh-btn"> <span class="gh-ico"></span> <span id="gh-text" class="gh-text">关注</span> </a> </span>
						
									
				</nav>
			</div>	        
		</span>
			<div id="content" class="textpage">
            <section id="content-container">
				<div id="content" class="textpage">
			    <a name="top"></a>
				
				

		<div class="content">
			<?xml version="1.0" encoding="iso-8859-1"?><span><p><a name="Title"></a></p>

<h1 id="Creating_Web_Sites_in_Windows_Azure_Using_WebMatrix">使用 WebMatrix 在 Windows Azure 中创建网站</h1>

<hr />

<p><a name="Overview"></a></p>

<h2 id="Overview">概述</h2>

<p>在此动手实验中，您将学习如何使用预打包应用程序库中的模板在 Windows Azure 中创建新网站。网站创建后，您将使用 Web Matrix 更新网站并部署更改。</p>

<p><a name="Objectives"></a></p>

<h3 id="Objectives">目标</h3>

<p>在此动手实验中，您将学习如何执行以下操作：</p>

<ul>
<li>使用模板库中的预打包应用程序在 Windows Azure 中创建新网站</li>
<li>使用 Web Matrix 2 更新网站并部署更改</li>
</ul>

<p><a name="Prerequisites"></a></p>

<h3 id="Prerequisites">先决条件</h3>

<p>下面是完成此动手实验需要满足的先决条件：</p>

<ul>
<li><a href="http://www.microsoft.com/web/webmatrix/next/">Microsoft Web Matrix 2</a></li>
<li>启用了网站预览的 Windows Azure 订阅 - <a href="http://aka.ms/WATK-FreeTrial">注册以免费试用</a></li>
</ul>
<blockquote>
<p><strong>注意：</strong>本实验设计为使用 Windows 7 操作系统。</p>
</blockquote>
<p><a name="Setup"></a></p>

<h3 id="Setup">设置</h3>

<p>为了执行此动手实验中的各项练习，需要对环境进行设置。</p>

<ol>
<li><p>打开 Windows 资源管理器窗口，浏览到此实验的 <strong>Source</strong> 文件夹。</p></li>
<li><p>右键单击 <strong>Setup.cmd</strong> 文件，然后单击<strong>“以管理员身份运行”</strong>。这将启动安装过程，该过程将配置环境并安装此实验的 Visual Studio 代码段。</p></li>
</ol>
<blockquote>
<p><strong>注意：</strong>请务必在运行安装程序前检查此实验的所有依赖项。</p>
</blockquote>
<hr />

<p><a name="Exercises"></a></p>

<h2 id="Exercises">练习</h2>

<p>此动手实验包括以下练习：</p>

<ol>
<li><a href="#Exercise1">练习 1：使用应用程序库创建 Windows Azure 网站</a></li>
<li><a href="#Exercise2">练习 2 - 使用 Web Matrix 2 自定义网站</a></li>
</ol>

<p><a name="Exercise1"></a></p>

<h3 id="Exercise_1_Creating_a_Windows_Azure_Web_Site_using_the_Applications_Gallery">练习 1：使用应用程序库创建 Windows Azure 网站</h3>

<p>在本练习中，您将使用应用程序库中的预打包 Web 应用程序创建一个新网站。</p>

<ol>
<li><p>转到 <a href="https://manage.windowsazure.com/">Windows Azure 管理门户</a>，并使用与您的订阅相关联的 Microsoft 凭据登录。</p>

<p><img src="images/login.png?raw=true" alt="登录到 Windows Azure 门户" title="登录到 Windows Azure 门户" />
</p>

<p><em>登录到 Windows Azure 管理门户</em></p></li>
<li><p>在命令栏上，单击<strong>“新建”</strong>。</p>

<p><img src="images/new-website.png?raw=true" alt="创建新网站" title="创建新网站" />
</p>

<p><em>创建新网站</em></p></li>
<li><p>单击<strong>“网站”</strong>，然后单击<strong>“从库中”</strong>。</p>

<p><img src="images/new-web-site-from-the-gallery.png?raw=true" alt="从库创建新网站" title="从库创建新网站" />
</p>

<p><em>从库创建新网站</em></p></li>
<li><p>在<strong>“博客”</strong>类别中选择 <strong>Umbraco CMS 5</strong> 应用程序。</p>

<p><img src="images/umbraco-cms-5-application.png?raw=true" alt="库中的 Umbraco 应用程序" title="库中的 Umbraco 应用程序" />
</p>

<p><em>库中的 Umbraco 应用程序</em></p></li>
<li><p>在<strong>“配置应用”</strong>页中键入一个可用 <strong>Url</strong>（例如 <em>umbracoSample</em>），然后从<strong>“数据库”</strong>下拉列表中选择<strong>“创建新的 SQL 数据库”</strong>。保留默认数据库<strong>用户名</strong>并提供一个<strong>密码</strong>。</p>

<p><img src="images/web-site-settings.png?raw=true" alt="配置网站设置" title="配置网站设置" />
</p>

<p><em>配置网站设置</em></p></li>
<li><p>在<strong>“指定数据库设置”</strong>页中，键入数据库名称（例如 <em>umbracoSampleDB</em>），然后从<strong>“服务器”</strong>下拉列表中选择<strong>“新的 SQL Database 服务器”</strong>。</p>
<blockquote>
<p><strong>注意：</strong>您也可以提供服务器名称以及管理员的用户名和密码，从而使用现有数据库服务器。</p>
</blockquote>
<p><img src="images/database-settings.png?raw=true" alt="配置数据库设置" title="配置数据库设置" />
</p>

<p><em>配置数据库设置</em></p></li>
<li><p>在<strong>“创建服务器”</strong>页中，配置您的数据库服务器登录用户名和密码。确保选中<strong>“允许 Windows Azure 服务访问服务器”</strong>选项，并且密码符合安全要求。</p>

<p><img src="images/database-admin.png?raw=true" alt="配置数据库管理员帐户" title="配置数据库管理员帐户" />
</p>

<p><em>配置数据库管理员帐户</em></p></li>
<li><p>网站成功创建后，就会列在<strong>“网站”</strong>部分，并且屏幕底部会显示一条消息。要开始安装 Umbraco，请单击<strong>“设置”</strong>。</p>

<p><img src="images/umbraco-web-site.png?raw=true" alt="Umbraco 网站" title="Umbraco 网站" />
</p>

<p><em>Umbraco 网站</em></p>
<blockquote>
<p><strong>注意：</strong>也可以单击网站打开其<strong>面板</strong>，然后单击<strong>“网站 URL”</strong>链接。</p>

<p><img src="images/umbraco-web-site-administration.png?raw=true" alt="Umbraco 网站面板" title="Umbraco 网站面板" />
</p>

<p><em>Umbraco 网站面板</em></p>
</blockquote></li>
<li><p>现在将配置 Umbraco 以在 Windows Azure 上运行。单击<strong>“安装 Umbraco 5.1”</strong>。</p>

<p><img src="images/configuring-umbraco-application.png?raw=true" alt="安装 Umbraco 应用程序" title="安装 Umbraco 应用程序" />
</p>

<p><em>安装 Umbraco 应用程序</em></p></li>
<li><p>将启动 Umbraco 安装向导并显示欢迎页面。单击<strong>“开始安装”</strong>开始安装过程。</p>

<p><img src="images/umbraco-installation-wizard-welcome.png?raw=true" alt="安装向导欢迎页" title="安装向导欢迎页" />
</p>

<p><em>安装向导欢迎页</em></p></li>
<li><p>在“数据库”页上，选中<strong>“我是高级用户，请让我输入连接字符串”</strong>。</p>

<p><img src="images/umbraco-connection-string-at-wizard.png?raw=true" alt="配置 Umbraco 数据库" title="配置 Umbraco 数据库" />
</p>

<p><em>配置 Umbraco 数据库</em></p></li>
<li><p>返回 Windows Azure 门户，并从左侧菜单中选择 <strong>SQL Database</strong>。</p>

<p><img src="images/umbraco-database.png?raw=true" alt="SQL Database" title="SQL Database" />
</p>

<p><em>SQL Database</em></p></li>
<li><p>单击 <strong>umbracoSampleDB</strong> 打开其面板。然后单击<strong>“显示连接字符串”</strong>。</p>

<p><img src="images/umbraco-connection-string.png?raw=true" alt="获取 Umbraco 数据库的连接字符串" title="获取 Umbraco 数据库的连接字符串" />
</p>

<p><em>获取 Umbraco 数据库的连接字符串</em></p></li>
<li><p>从<strong>“连接字符串”</strong>对话框中复制 <strong>ADO.NET</strong> 连接字符串。</p>

<p><img src="images/umbraco-adonet-connection-string.png?raw=true" alt="复制 Umbraco ADO.NET 连接字符串" title="复制 Umbraco ADO.NET 连接字符串" />
</p>

<p><em>复制 Umbraco ADO.NET 连接字符串</em></p></li>
<li><p>返回 Umbraco 安装程序并粘贴刚才复制的连接字符串。将 <strong>{your_password_here}</strong> 占位符替换为您的数据库服务器登录密码。单击<strong>“安装”</strong>以便继续。</p>

<p><img src="images/umbraco-inserting-connection-string-at-wizard.png?raw=true" alt="配置连接字符串" title="配置连接字符串" />
</p>

<p><em>配置连接字符串</em></p></li>
<li><p>将配置您的应用程序数据库并填充数据。此过程完成后单击<strong>“继续”</strong>。</p>

<p><img src="images/umbraco-database-startup.png?raw=true" alt="配置 Umbraco 数据库" title="配置 Umbraco 数据库" />
</p>

<p><em>配置 Umbraco 数据库</em></p></li>
<li><p>下一步骤是创建 Umbraco 管理员用户帐户。输入所需信息，然后单击<strong>“创建用户”</strong>。</p>

<p><img src="images/umbraco-application-admin.png?raw=true" alt="创建 Umbraco 的管理员用户" title="创建 Umbraco 的管理员用户" />
</p>

<p><em>创建 Umbraco 的管理员用户</em></p></li>
<li><p>单击<strong>“安装”</strong>安装初学者工具包，如下图所示。</p>
<blockquote>
<p><strong>注意：</strong>使用 Umbraco 初学者工具包可以轻松启动您的 Umbraco 网站，其中提供了现成的内容和样式。</p>
</blockquote>
<p><img src="images/install-starter-kit.png?raw=true" alt="安装初学者工具包" title="安装初学者工具包" />
</p>

<p><em>安装初学者工具包</em></p></li>
<li><p>等待应用程序重新启动。完成后，单击<strong>“继续”</strong>。</p>

<p><img src="images/install-starter-kit-finished.png?raw=true" alt="初学者工具包安装成功" title="初学者工具包安装成功" />
</p>

<p><em>初学者工具包安装成功</em></p></li>
<li><p>您将看到安装向导的最后一个屏幕。单击<strong>“预览您的新网站”</strong>打开您的应用程序。</p>

<p><img src="images/wizard-final-screen.png?raw=true" alt="向导已完成" title="向导已完成" />
</p>

<p><em>向导已完成</em></p></li>
<li><p>将打开 <strong>Umbraco 主页</strong>。</p>

<p><img src="images/umbraco-homepage.png?raw=true" alt="Umbraco 主页" title="Umbraco 主页" />
</p>

<p><em>Umbraco 主页</em></p></li>
</ol>

<p><a name="Exercise2"></a></p>

<h3 id="Exercise_2_Customizing_a_Web_Site_using_Web_Matrix_2">练习 2 - 使用 Web Matrix 2 自定义网站</h3>

<p>在此练习中，您将使用 Web Matrix 2 更新您的应用程序。您将在图书视图中添加一个 Facebook 的“Like”按钮。</p>

<ol>
<li><p>转到 <a href="https://manage.windowsazure.com/">Windows Azure 管理门户</a>，并使用与您的订阅相关联的 Microsoft 凭据登录。</p>

<p><img src="images/login.png?raw=true" alt="登录到 Windows Azure 门户" title="登录到 Windows Azure 门户" />
</p>

<p><em>登录到 Windows Azure 管理门户</em></p></li>
<li><p>选择 Umbraco 网站 (<em>umbracoSample</em>) 打开网站面板，然后单击<strong>“下载发布配置文件”</strong>链接。</p>
<blockquote>
<p><strong>注意：</strong>对于启用的每种发布方法，<em>发布配置文件</em> 包含将 Web 应用程序发布到 Windows Azure 网站所需的全部信息。发布配置文件包含有启用了发布方法的每个端点的 URL，以及连接到这些端点和进行身份验证所需的用户凭据和数据库字符串。<strong>Microsoft WebMatrix</strong> 和 <strong>Microsoft Visual Web Developer</strong> 都支持读取发布配置文件以便自动配置这些程序，从而将 Web 应用程序发布到 Windows Azure 网站。</p>
</blockquote>
<p><img src="images/download-publish-profile.png?raw=true" alt="下载发布配置文件" title="下载发布配置文件" />
</p>

<p><em>下载发布配置文件</em></p></li>
<li><p>将文件保存到一个已知位置。</p>

<p><img src="images/save-publish-profile.png?raw=true" alt="保存发布配置文件" title="保存发布配置文件" />
</p>

<p><em>保存发布配置文件</em></p></li>
<li><p>打开 Web Matrix 2。</p></li>
<li><p>在 Web Matrix 的<strong>“打开网站”</strong>选项中，选择<strong>“远程网站”</strong>。</p>

<p><img src="images/webmatrix-open-site.png?raw=true" alt="打开网站" title="打开网站" />
</p>

<p><em>打开网站</em></p></li>
<li><p>单击<strong>“导入发布设置”</strong>并选择您刚才下载的发布配置文件。</p>

<p><img src="images/webmatrix-import-publish-settings.png?raw=true" alt="导入发布设置" title="导入发布设置" />
</p>

<p><em>导入发布设置</em></p></li>
<li><p>选择文件后，输入一个<strong>网站名称</strong>并单击<strong>“确定”</strong>。</p>

<p><img src="images/webmatrix-remote-site-name.png?raw=true" alt="WebMatrix 远程网站名称" title="WebMatrix 远程网站名称" />
</p>

<p><em>WebMatrix 远程网站名称</em></p></li>
<li><p>打开<strong>“视图”</strong>文件夹并双击 <strong>BookPage.cshtml</strong> 视图。</p>

<p><img src="images/webmatrix-bookpage-view.png?raw=true" alt="图书视图" title="图书视图" />
</p>

<p><em>图书视图</em></p></li>
<li><p>将以下代码添加到 <code>&lt;div class=&quot;product-page cf&quot;&gt;</code> 元素之前。</p>

<p>此代码将包含 JavaScript SDK (JS SDK)，使您可以使用 Facebook 社交插件。</p>

<span class="codelanguage">JavaScript</span><pre><code class="JavaScript">&lt;div id=<span style="color:#8B0000">&quot;fb-root&quot;</span>&gt;&lt;/div&gt; &lt;script&gt; (<span style="color:#0000FF">function</span>(d, s, id) {
        <span style="color:#0000FF">var</span> js, fjs = d.getElementsByTagName(s)[0];
        <span style="color:#0000FF">if</span> (d.getElementById(id)) <span style="color:#0000FF">return</span>; js = d.createElement(s); js.id = id; js.src = <span style="color:#8B0000">&quot;//connect.facebook.net/en_US/all.js#xfbml=1&quot;</span>; fjs.parentNode.insertBefore(js, fjs); }(<span style="color:#0000FF">document</span>, &#39;script&#39;, &#39;facebook-jssdk&#39;)); &lt;/script&gt;
</code></pre>
<blockquote>
<p><strong>注意：</strong>您可以从<a href="http://developers.facebook.com/docs/reference/plugins/like/">此处</a>了解有关 Facebook“Like”按钮的更多信息。</p>
</blockquote>
<p><img src="images/bookview-fbsdk.png?raw=true" alt="添加 Facebook 的 SDK 代码" title="添加 Facebook 的 SDK 代码" />
</p>

<p><em>添加 Facebook 的 SDK 代码</em></p></li>
<li><p>将以下代码添加到 <code>&lt;Options&gt;</code> 标头之前。</p>
<blockquote>
<p><strong>注意：</strong>Like 按钮使用户可以在 Facebook 上与好友共享您的内容。用户单击您的网站上的“Like”按钮时，该用户好友的好友动态中会显示一个故事以及指向您网站的链接。</p>
</blockquote>
<span class="codelanguage">HTML</span><pre><code class="HTML"><span style="color:#0000FF">&lt;</span><span style="color:#800000">div</span> <span style="color:#FF0000">class</span>=<span style="color:#0000FF">&quot;fb-like&quot;</span>
    <span style="color:#FF0000">data</span>-<span style="color:#FF0000">href</span>=<span style="color:#0000FF">&quot;@HttpContext.Current.Request.Url.ToString()&quot;</span> 
    <span style="color:#FF0000">data</span>-<span style="color:#FF0000">send</span>=<span style="color:#0000FF">&quot;false&quot;</span> <span style="color:#FF0000">data</span>-<span style="color:#FF0000">width</span>=<span style="color:#0000FF">&quot;100&quot;</span> <span style="color:#FF0000">data</span>-<span style="color:#FF0000">show</span>-<span style="color:#FF0000">faces</span>=<span style="color:#0000FF">&quot;false&quot;</span><span style="color:#0000FF">&gt;</span>
<span style="color:#0000FF">&lt;/</span><span style="color:#800000">div</span><span style="color:#0000FF">&gt;</span>
</code></pre>

<p><img src="images/webmatrix-fbbutton.png?raw=true" alt="添加 Facebook 的 Like 按钮" title="添加 Facebook 的 Like 按钮" />
</p>

<p><em>添加 Facebook 的 Like 按钮</em></p>
<blockquote>
<p><strong>注意：</strong></p>

<ul>
<li><strong>data-href</strong> 属性指定喜欢的 URL。在本例中，为当前 URL。</li>
<li><strong>data-send</strong> 属性指定是否随“Like”按钮包含“Send”按钮。在本例中，该设置为 false。</li>
</ul>
</blockquote></li>
<li><p>保存编辑后的文件。</p></li>
<li><p>单击 WebMatrix 功能区中的<strong>“运行”</strong>按钮打开您的网站。单击 <strong>Books</strong>（图书）打开图书页。</p>

<p><img src="images/umbraco-homepage-webmatrix.png?raw=true" alt="Umbraco 主页" title="Umbraco 主页" />
</p>

<p><em>Umbraco 主页</em></p></li>
<li><p>单击 <strong>Umbraco's User Guide</strong>（Umbraco 用户指南）或任意其他图书页面打开图书详细信息页面。</p>

<p><img src="images/umbraco-books-webmatrix.png?raw=true" alt="Umbraco 图书页" title="Umbraco 图书页" />
</p>

<p><em>Umbraco 图书页</em></p></li>
<li><p>在图书的详细信息页面中可以看到刚才添加的 Facebook <strong>Like</strong> 按钮。</p>

<p><img src="images/umbraco-like-button.png?raw=true" alt="查看 Like 按钮" title="查看 Like 按钮" />
</p>

<p><em>查看 Like 按钮</em></p></li>
</ol>

<p><a name="Summary"></a></p>

<h2 id="Summary">小结</h2>

<p>在此动手实验中，您学习了如何使用预打包应用程序库中的模板在 Windows Azure 中创建新网站。网站创建后，您使用 Web Matrix 更新了网站并部署了更改。此动手实验简单说明了结合使用 WebMatrix 和 Windows Azure 网站开发网站是多么的容易。</p> </span>
		</div>
	<br/>
	<p><a href="#top">返回页首</a></p>


				</div>
			</section>
			<footer>
				<div class="footer-sitemap" style="border-top:0"></div>
				<div class="footer-bottom">
					<ul>
						<li class="footer-copyright"><a href="http://www.microsoft.com"><img alt="microsoft" src="images/microsoft.png" /></a></li>					
												<li><a href="https://github.com/WindowsAzure-TrainingKit/HOL-WebAppGalleryAzureWebSites/issues" target="_new">记录问题</a></li>
												<li><a href="mailto:azcfeed@microsoft.com?subject=Windows Azure Training Kit">联系我们</a></li>
						<li><a href="EULA.htm">使用条款</a></li>
						<li><a href=".\">浏览内容</a></li>
						<li>&copy; 2012 Microsoft</li>
					</ul>
				</div>
			</footer>
			</div>
        </div>
    </div>
</body>
</html>

